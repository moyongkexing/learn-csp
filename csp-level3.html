<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSP Level 3 - ã‚ˆã‚Šå®‰å…¨ãªnonce + strict-dynamicæ–¹å¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        h1 {
            color: #185a9d;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5em;
        }
        
        .intro-section {
            background: #e3f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .intro-section h2 {
            color: #185a9d;
            margin-bottom: 15px;
        }
        
        .intro-section p {
            line-height: 1.8;
            margin-bottom: 10px;
        }
        
        .csp-header {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow: hidden;
        }
        
        .csp-header::before {
            content: "CSP Level 3";
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 0.8em;
            color: #1976d2;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: bold;
        }
        
        .nonce-display {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            margin: 0 5px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .demo-section {
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            position: relative;
            transition: all 0.3s;
        }
        
        .demo-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .safe {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4caf50;
        }
        
        .info {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
        }
        
        .danger {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 2px solid #f44336;
        }
        
        h2 {
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h3 {
            color: #2d3748;
            margin: 20px 0 10px 0;
        }
        
        .icon {
            font-size: 1.5em;
        }
        
        button {
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            margin: 10px 5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .console-output {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            min-height: 60px;
            position: relative;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .console-output.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .console-output::before {
            content: "ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«";
            position: absolute;
            top: -10px;
            left: 10px;
            background: #1a202c;
            padding: 0 10px;
            font-size: 12px;
            color: #718096;
        }
        
        .console-log {
            color: #68d391;
        }
        
        .console-error {
            color: #fc8181;
        }
        
        .console-warn {
            color: #f6e05e;
        }
        
        .console-info {
            color: #63b3ed;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre;
        }
        
        .code-block .comment {
            color: #78909c;
        }
        
        .code-block .nonce-attr {
            color: #ffeb3b;
            font-weight: bold;
        }
        
        .code-block .keyword {
            color: #ce93d8;
        }
        
        .code-block .string {
            color: #f48fb1;
        }
        
        .highlight {
            background: #ffd54f;
            color: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .explanation {
            background: #f7fafc;
            border-left: 4px solid #185a9d;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .flow-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .flow-item {
            text-align: center;
            margin: 10px;
        }
        
        .flow-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: white;
            margin: 0 auto 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .dynamic-demo {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .security-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .security-badge::before {
            content: "ğŸ”’";
            font-size: 1.2em;
        }
        
        .attack-result {
            background: #fff5f5;
            border: 2px solid #f44336;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .attack-result.show {
            display: block;
            animation: shake 0.5s ease-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body>
    <div class="security-badge">
        CSP Level 3 ä¿è­·ä¸­
    </div>
    
    <div class="container">
        <h1>ğŸš€ CSP Level 3 - æ¬¡ä¸–ä»£ã®XSSå¯¾ç­–</h1>
        
        <div class="intro-section">
            <h2>ğŸ›¡ï¸ CSP Level 3ã®æ–°æ©Ÿèƒ½</h2>
            <p><strong>nonce</strong>ï¼ˆNumber used onceï¼‰ã¨<strong>strict-dynamic</strong>ã®çµ„ã¿åˆã‚ã›ã§ã€ã‚ˆã‚Šå¼·å›ºãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å®Ÿç¾ã—ã¾ã™ã€‚</p>
            <p>â€¢ <strong>nonce</strong>ï¼šæ¯å›ç•°ãªã‚‹ãƒ©ãƒ³ãƒ€ãƒ ãªå€¤ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã‚’åˆ¶å¾¡</p>
            <p>â€¢ <strong>strict-dynamic</strong>ï¼šä¿¡é ¼ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚è‡ªå‹•çš„ã«ä¿¡é ¼</p>
        </div>
        
        <div class="csp-header">
            <strong>ç¾åœ¨ã®CSPè¨­å®šï¼ˆLevel 3ï¼‰ï¼š</strong><br>
            Content-Security-Policy: script-src 'nonce-<span class="nonce-display">r@nd0m$tr1ng</span>' 'strict-dynamic';<br>
            object-src 'none'; base-uri 'none';
        </div>
        
        <div class="demo-section info">
            <h2><span class="icon">ğŸ²</span> nonceï¼ˆãƒŠãƒ³ã‚¹ï¼‰ã®ä»•çµ„ã¿</h2>
            <p>nonceã¯ã€ŒNumber used onceã€ã®ç•¥ã§ã€<strong>æ¯å›ç•°ãªã‚‹ä¹±æ•°</strong>ã§ã™ã€‚</p>
            
            <div class="flow-diagram">
                <div class="flow-item">
                    <div class="flow-icon">1</div>
                    <strong>ã‚µãƒ¼ãƒãƒ¼</strong><br>
                    ãƒ©ãƒ³ãƒ€ãƒ ãªnonceã‚’ç”Ÿæˆ
                </div>
                <div class="flow-item">
                    <div class="flow-icon">2</div>
                    <strong>HTML</strong><br>
                    scriptã‚¿ã‚°ã«nonceä»˜ä¸
                </div>
                <div class="flow-item">
                    <div class="flow-icon">3</div>
                    <strong>ãƒ–ãƒ©ã‚¦ã‚¶</strong><br>
                    nonceãŒä¸€è‡´ã™ã‚‹ã‹ç¢ºèª
                </div>
            </div>
            
            <div class="code-block"><span class="comment">// ã‚µãƒ¼ãƒãƒ¼å´ã§nonceã‚’ç”Ÿæˆï¼ˆNode.jsä¾‹ï¼‰</span>
<span class="keyword">const</span> crypto = <span class="keyword">require</span>(<span class="string">'crypto'</span>);
<span class="keyword">const</span> nonce = crypto.randomBytes(16).toString(<span class="string">'base64'</span>);
<span class="comment">// çµæœ: "r@nd0m$tr1ng" ï¼ˆæ¯å›å¤‰ã‚ã‚‹ï¼‰</span></div>
        </div>
        
        <div class="demo-section safe">
            <h2><span class="icon">âœ…</span> nonceã‚’æŒã¤æ­£å½“ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h2>
            <div class="code-block">&lt;script <span class="nonce-attr">nonce="r@nd0m$tr1ng"</span>&gt;
    console.log("nonceãŒä¸€è‡´ã—ãŸã®ã§å®Ÿè¡Œã•ã‚Œã¾ã™");
    
    // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­£å¸¸ãªå‡¦ç†
    const userData = { id: 123, name: "å±±ç”°å¤ªéƒ" };
    console.log("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿:", userData);
&lt;/script&gt;</div>
            <button onclick="demonstrateValidNonce()">nonceã‚ã‚Šã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ</button>
            <div id="validConsole" class="console-output"></div>
        </div>
        
        <div class="demo-section danger">
            <h2><span class="icon">âŒ</span> nonceãªã— = å®Ÿè¡Œæ‹’å¦</h2>
            <div class="code-block">&lt;script&gt;
    // æ”»æ’ƒè€…ãŒæ³¨å…¥ã—ã‚ˆã†ã¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆnonceãŒãªã„ï¼‰
    console.log("æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ");
    document.cookie;
&lt;/script&gt;

&lt;script src="https://evil.com/malicious.js"&gt;&lt;/script&gt;</div>
            <button onclick="demonstrateInvalidScript()">nonceãªã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œï¼ˆå¤±æ•—ï¼‰</button>
            <div id="invalidConsole" class="console-output"></div>
        </div>
        
        <div class="demo-section safe">
            <h2><span class="icon">âš¡</span> strict-dynamicã®å®Ÿéš›ã®å‹•ä½œ</h2>
            <p>nonceã‚’æŒã¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰<strong>å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆ</strong>ã‚‚è‡ªå‹•çš„ã«ä¿¡é ¼ã•ã‚Œã¾ã™ï¼</p>
            
            <div class="code-block">&lt;script <span class="nonce-attr">nonce="r@nd0m$tr1ng"</span>&gt;
    console.log("[è¦ª] nonceã‚ã‚Šã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œé–‹å§‹");
    
    // å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ˆãã‚ã‚‹å‹•çš„ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ
    // ä¾‹ï¼šGoogle Analyticsã€åºƒå‘Šã‚¿ã‚°ã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãªã©
    const script = document.createElement('script');
    script.textContent = `
        console.log("[å­] å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ");
        console.log("[å­] nonceãªã—ã§ã‚‚strict-dynamicã«ã‚ˆã‚Šå®Ÿè¡Œå¯èƒ½");
        
        // ã•ã‚‰ã«å­«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆï¼ˆãƒã‚¹ãƒˆã—ãŸå‹•çš„ç”Ÿæˆï¼‰
        const grandchildScript = document.createElement('script');
        grandchildScript.textContent = 
            'console.log("[å­«] ãƒã‚¹ãƒˆã—ã¦ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚å®Ÿè¡Œå¯èƒ½");';
        document.body.appendChild(grandchildScript);
    `;
    document.body.appendChild(script);
&lt;/script&gt;</div>
            
            <button onclick="demonstrateStrictDynamic()">strict-dynamicã®å‹•ä½œã‚’ç¢ºèª</button>
            <div id="dynamicConsole" class="console-output"></div>
            
            <div class="explanation" style="margin-top: 20px;">
                <h4>ãªãœã“ã‚ŒãŒé‡è¦ãªã®ã‹ï¼Ÿ</h4>
                <p>å¤šãã®ãƒ¢ãƒ€ãƒ³ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€å‹•çš„ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ï¼š</p>
                <ul style="margin-left: 20px;">
                    <li>Google Analytics ãªã©ã®åˆ†æãƒ„ãƒ¼ãƒ«</li>
                    <li>åºƒå‘Šã‚¿ã‚°ã‚„ãƒªã‚¿ãƒ¼ã‚²ãƒ†ã‚£ãƒ³ã‚°ãƒ”ã‚¯ã‚»ãƒ«</li>
                    <li>ãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚„ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«</li>
                    <li>A/Bãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</li>
                </ul>
                <p>strict-dynamicãŒãªã„ã¨ã€ã“ã‚Œã‚‰å…¨ã¦ã«nonceã‚’ä»˜ä¸ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€å®Ÿè£…ãŒå›°é›£ã§ã—ãŸã€‚</p>
            </div>
        </div>
        
        <div class="demo-section danger">
            <h2><span class="icon">ğŸ›¡ï¸</span> JSONPãƒã‚¤ãƒ‘ã‚¹ã‚‚é˜²ã’ã‚‹ï¼</h2>
            <p>CSP Level 3ã§ã¯ã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã¯<strong>å®Œå…¨ã«ç„¡è¦–</strong>ã•ã‚Œã¾ã™ã€‚</p>
            
            <div class="code-block">// æ”»æ’ƒè€…ãŒè©¦ã¿ã‚‹JSONPãƒã‚¤ãƒ‘ã‚¹ï¼ˆCSP Level 2ãªã‚‰æˆåŠŸã™ã‚‹ï¼‰
&lt;script src="https://trusted-cdn.com/jsonp?callback=console.log('XSS');document.cookie;//"&gt;&lt;/script&gt;

// CSP Level 3ã§ã¯ã€nonceãŒãªã„ãŸã‚å®Ÿè¡Œã•ã‚Œãªã„</div>
            <button onclick="demonstrateJSONPBlock()">JSONPãƒã‚¤ãƒ‘ã‚¹ã‚’è©¦ã™ï¼ˆå¤±æ•—ï¼‰</button>
            <div id="jsonpBlockConsole" class="console-output"></div>
            
            <div class="attack-result" id="jsonpComparisonResult">
                <h4>CSP Level 2 vs Level 3 ã®æ¯”è¼ƒ</h4>
                <table style="width: 100%; margin-top: 15px;">
                    <tr>
                        <th style="text-align: left; padding: 10px; background: #f7fafc;">æ”»æ’ƒæ‰‹æ³•</th>
                        <th style="padding: 10px; background: #f7fafc;">Level 2</th>
                        <th style="padding: 10px; background: #f7fafc;">Level 3</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">JSONPãƒã‚¤ãƒ‘ã‚¹</td>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; text-align: center; color: #f44336;">âŒ æˆåŠŸ</td>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; text-align: center; color: #4caf50;">âœ… ãƒ–ãƒ­ãƒƒã‚¯</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">AngularJSãƒã‚¤ãƒ‘ã‚¹</td>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; text-align: center; color: #f44336;">âŒ æˆåŠŸ</td>
                        <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; text-align: center; color: #4caf50;">âœ… ãƒ–ãƒ­ãƒƒã‚¯</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">ä¿¡é ¼ã•ã‚ŒãŸCDNã‹ã‚‰ã®æ”»æ’ƒ</td>
                        <td style="padding: 10px; text-align: center; color: #f44336;">âŒ æˆåŠŸ</td>
                        <td style="padding: 10px; text-align: center; color: #4caf50;">âœ… ãƒ–ãƒ­ãƒƒã‚¯</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div class="explanation">
            <h3>ğŸ¯ ãªãœCSP Level 3ãŒå„ªã‚Œã¦ã„ã‚‹ã®ã‹</h3>
            <ul style="margin-left: 20px; line-height: 1.8;">
                <li><strong>äºˆæ¸¬ä¸å¯èƒ½ï¼š</strong>æ¯å›ç•°ãªã‚‹nonceã§ã€æ”»æ’ƒè€…ã¯æ¨æ¸¬ã§ããªã„</li>
                <li><strong>ã‚·ãƒ³ãƒ—ãƒ«ï¼š</strong>ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒªã‚¹ãƒˆã®ç®¡ç†ãŒä¸è¦</li>
                <li><strong>å®Ÿç”¨çš„ï¼š</strong>strict-dynamicã§æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚‚å‹•ä½œ</li>
                <li><strong>å …ç‰¢ï¼š</strong>JSONPã‚„AngularJSãƒã‚¤ãƒ‘ã‚¹ã‚‚é˜²ã’ã‚‹</li>
            </ul>
        </div>
    </div>
    
    <script>
        function addConsoleLog(elementId, message, type = 'log') {
            const console = document.getElementById(elementId);
            console.classList.add('show');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'console-error' : 
                             type === 'warn' ? 'console-warn' : 
                             type === 'info' ? 'console-info' :
                             'console-log';
            
            console.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }
        
        function demonstrateValidNonce() {
            const consoleId = 'validConsole';
            document.getElementById(consoleId).innerHTML = '';
            
            // ã‚³ãƒ¼ãƒ‰ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹é€šã‚Šã®å‡ºåŠ›
            setTimeout(() => {
                addConsoleLog(consoleId, 'nonceãŒä¸€è‡´ã—ãŸã®ã§å®Ÿè¡Œã•ã‚Œã¾ã™');
            }, 300);
            
            setTimeout(() => {
                addConsoleLog(consoleId, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿: {id: 123, name: "å±±ç”°å¤ªéƒ"}');
            }, 800);
        }
        
        function demonstrateInvalidScript() {
            const consoleId = 'invalidConsole';
            document.getElementById(consoleId).innerHTML = '';
            
            // CSPã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            setTimeout(() => {
                addConsoleLog(consoleId, 'Refused to execute inline script because it violates the following Content Security Policy directive: "script-src \'nonce-r@nd0m$tr1ng\' \'strict-dynamic\'"', 'error');
            }, 300);
            
            setTimeout(() => {
                addConsoleLog(consoleId, 'Either the \'unsafe-inline\' keyword, a hash (\'sha256-...\'), or a nonce (\'nonce-...\') is required to enable inline execution.', 'error');
            }, 700);
            
            setTimeout(() => {
                addConsoleLog(consoleId, 'Refused to load the script \'https://evil.com/malicious.js\' because it violates the following Content Security Policy directive: "script-src \'nonce-r@nd0m$tr1ng\' \'strict-dynamic\'"', 'error');
            }, 1100);
        }
        
        function demonstrateStrictDynamic() {
            const consoleId = 'dynamicConsole';
            document.getElementById(consoleId).innerHTML = '';
            
            // ã‚³ãƒ¼ãƒ‰ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹é€šã‚Šã®å®Ÿè¡Œé †åºã§å‡ºåŠ›
            setTimeout(() => {
                addConsoleLog(consoleId, '[è¦ª] nonceã‚ã‚Šã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œé–‹å§‹');
            }, 300);
            
            setTimeout(() => {
                addConsoleLog(consoleId, '[å­] å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ');
            }, 800);
            
            setTimeout(() => {
                addConsoleLog(consoleId, '[å­] nonceãªã—ã§ã‚‚strict-dynamicã«ã‚ˆã‚Šå®Ÿè¡Œå¯èƒ½');
            }, 1200);
            
            setTimeout(() => {
                addConsoleLog(consoleId, '[å­«] ãƒã‚¹ãƒˆã—ã¦ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚å®Ÿè¡Œå¯èƒ½');
            }, 1600);
        }
        
        function demonstrateJSONPBlock() {
            const consoleId = 'jsonpBlockConsole';
            const comparisonResult = document.getElementById('jsonpComparisonResult');
            
            document.getElementById(consoleId).innerHTML = '';
            
            // CSPã‚¨ãƒ©ãƒ¼ï¼ˆJSONPãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ï¼‰
            setTimeout(() => {
                addConsoleLog(consoleId, 'Refused to load the script \'https://trusted-cdn.com/jsonp?callback=console.log(\'XSS\');document.cookie;//\' because it violates the following Content Security Policy directive: "script-src \'nonce-r@nd0m$tr1ng\' \'strict-dynamic\'"', 'error');
            }, 300);
            
            setTimeout(() => {
                addConsoleLog(consoleId, 'Note that \'strict-dynamic\' is present, so host-based allowlisting is disabled.', 'error');
            }, 700);
            
            setTimeout(() => {
                addConsoleLog(consoleId, 'strict-dynamicãŒæœ‰åŠ¹ãªãŸã‚ã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã¯ç„¡è¦–ã•ã‚Œã¾ã™', 'warn');
            }, 1100);
            
            // æ¯”è¼ƒè¡¨ã‚’è¡¨ç¤º
            setTimeout(() => {
                comparisonResult.classList.add('show');
            }, 1500);
        }
    </script>
</body>
</html>